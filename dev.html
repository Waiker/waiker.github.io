<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>TWA ‚Äî –ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤ (dev)</title>

  <!-- Font Awesome (–∏–∫–æ–Ω–∫–∏) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="assets/css/style.css" />
  <link rel="stylesheet" href="assets/css/dev.css" />

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.BackButton.hide();
  </script>
</head>
<body>

  <!-- header with compact search -->
  <div class="topbar">
    <div class="search-wrap">
      <div class="search" role="search">
        <i class="fa-solid fa-magnifying-glass"></i>
        <input id="searchInput" placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–∞ –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..." autocomplete="off" />
      </div>
      <div id="suggestBox" aria-hidden="true"></div>
    </div>
  </div>

  <div class="banner-wrap">
    <div id="banner-carousel">
      <div class="banner" style="background: radial-gradient(87.56% 85.19% at 87.37% -15.14%, rgb(83, 255, 214) 0%, rgba(51, 169, 255, 0) 100%), radial-gradient(67.94% 70.77% at 0% 100%, rgb(113, 195, 255) 0%, rgb(93, 99, 255) 100%);" onclick="window.location.href='pages/banner1.html'">
        <div class="banner-text">
          <div class="banner-title">üî• –ù–µ–¥–µ–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
          <div class="banner-subtitle">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ></div>
        </div>
        <img class="banner-icon" src="assets/img/banner1.png" alt="–ù–µ–¥–µ–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫">
      </div>
      <div class="banner" style="background: linear-gradient(to right, #7B4FFF, #8E2DE2, #9C2ACE)" onclick="window.location.href='pages/banner2.html'">
        <div class="banner-text">
          <div class="banner-title">üéØ –î–ª—è —Ç–µ—Ö, –∫—Ç–æ –∑–Ω–∞–µ—Ç —á–µ–≥–æ —Ö–æ—á–µ—Ç</div>
          <div class="banner-subtitle">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ></div>
        </div>
        <img class="banner-icon" src="assets/img/banner2.png" alt="–ú–µ—Å—è—Ü —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫">
      </div>
      <div class="banner" style="background-image: linear-gradient(45deg, #FFD700, #CD853F)" onclick="window.location.href='pages/banner3.html'">
        <div class="banner-text">
          <div class="banner-title">üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∫–∞–Ω–∞–ª–æ–≤</div>
          <div class="banner-subtitle">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ></div>
        </div>
        <img class="banner-icon" src="assets/img/banner3.png" alt="–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å">
      </div>
    </div>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–∞—Ä—É—Å–µ–ª–∏ (—Ç–æ–ª—å–∫–æ –≤ dev) -->
    <div class="banner-dots" aria-hidden="true">
      <span class="banner-dot active"></span>
      <span class="banner-dot"></span>
      <span class="banner-dot"></span>
    </div>
  </div>

  <div id="catWrap">
    <div id="categories" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"></div>
  </div>

  <main class="container">

    <section id="page-catalog" class="page active">
      <div class="controls">
        <div class="small-muted" id="countInfo">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div style="margin-left:auto">
          <select id="sortSelect">
            <option value="name_asc">–ü–æ –∏–º–µ–Ω–∏ (–ê‚Üí–Ø)</option>
            <option value="name_desc">–ü–æ –∏–º–µ–Ω–∏ (–Ø‚Üí–ê)</option>
            <option value="added_desc">–ü–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</option>
          </select>
        </div>
      </div>
      <div id="courses" class="courses"></div>
    </section>

    <section id="page-bookmarks" class="page">
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <h2 style="margin:0">–ó–∞–∫–ª–∞–¥–∫–∏</h2>
        <select id="bmSort" style="margin-left:auto">
          <option value="added_desc">–ü–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ)</option>
          <option value="added_asc">–ü–æ –¥–∞—Ç–µ (—Å—Ç–∞—Ä—ã–µ)</option>
          <option value="name_asc">–ü–æ –∏–º–µ–Ω–∏</option>
        </select>
      </div>
      <div id="bookmarksList" class="courses" style="margin-top:12px"></div>
    </section>

    <section id="page-watched" class="page">
      <h2 style="margin:0 0 8px 0">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</h2>
      <div id="watchedList" class="courses"></div>
    </section>

    <section id="page-profile" class="page">
      <div class="profile-page">
        <!-- Hero -->
        <div class="profile-hero">
          <div id="profileAvatar" class="profile-avatar"></div>
          <h1 id="profileName" class="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
          <div id="profileBadges" class="profile-badges"></div>
        </div>

        <!-- Stats cards -->
        <div class="profile-stats-grid">
          <div class="profile-stat-card">
            <div class="profile-stat-value" id="profileProgressText">0 –∏–∑ 0</div>
            <div class="profile-stat-label">–ö—É—Ä—Å–æ–≤ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</div>
            <div class="profile-progress-bar profile-progress-bar--compact">
              <div id="profileProgressFill" class="profile-progress-fill" style="width:0%"></div>
            </div>
          </div>
          <div class="profile-stat-card">
            <div class="profile-stat-value" id="profileBookmarksCount">0</div>
            <div class="profile-stat-label">–í –∑–∞–∫–ª–∞–¥–∫–∞—Ö</div>
          </div>
        </div>
        <p class="profile-progress-hint" id="profileProgressHint">–í—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª–∏ 0 –∫—É—Ä—Å–æ–≤ –∏–∑ 0 –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</p>

        <!-- Achievements -->
        <div class="profile-section">
          <h2 class="profile-section-title">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
          <div id="profileAchievements" class="profile-achievements"></div>
        </div>

        <!-- Belt, Division, Club: form or display -->
        <div class="profile-section profile-belt-section">
          <div class="profile-section-header">
            <h2 class="profile-section-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—Å</h2>
            <button type="button" id="profileEditBtn" class="profile-edit-icon-btn" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" aria-label="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
              <i class="fa-solid fa-pen"></i>
            </button>
          </div>
          <div id="profileBeltDisplay" class="profile-belt-display" style="display:none">
            <div class="profile-belt-card">
              <img id="profileBeltIcon" class="profile-belt-icon" src="" alt="">
              <div class="profile-belt-info">
                <span id="profileBeltLabel" class="profile-belt-label"></span>
                <span id="profileDivisionBadge" class="profile-division-badge"></span>
                <span id="profileClubDisplay" class="profile-club-row" style="display:none"></span>
              </div>
            </div>
          </div>
          <div id="profileBeltForm" class="profile-belt-form">
            <h3 class="profile-form-title">–ü–æ—è—Å, —Ä–∞–∑–¥–µ–ª –∏ –∫–ª—É–±</h3>
            <label class="profile-form-label">–ü–æ—è—Å</label>
            <div id="profileBeltPicker" class="profile-belt-picker"></div>
            <label class="profile-form-label">–†–∞–∑–¥–µ–ª</label>
            <div id="profileDivisionPicker" class="profile-division-picker"></div>
            <label class="profile-form-label">–ö–ª—É–± <span class="profile-form-optional">(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label>
            <input type="text" id="profileClubInput" class="profile-club-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª—É–±–∞" maxlength="100" autocomplete="off">
            <div class="profile-form-actions">
              <button type="button" id="profileCancelBeltBtn" class="profile-cancel-btn" style="display:none">–û—Ç–º–µ–Ω–∞</button>
              <button type="button" id="profileSaveBeltBtn" class="profile-save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <div id="toast"></div>

  <nav class="bottom-nav" role="navigation">
    <div class="nav-item active" data-target="page-catalog"><i class="fa-solid fa-book"></i>–ö–∞—Ç–∞–ª–æ–≥</div>
    <div class="nav-item" data-target="page-bookmarks"><i class="fa-solid fa-star"></i>–ó–∞–∫–ª–∞–¥–∫–∏</div>
    <div class="nav-item" data-target="page-watched"><i class="fa-solid fa-check"></i>–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</div>
    <div class="nav-item" data-target="page-profile"><i class="fa-solid fa-user"></i>–ü—Ä–æ—Ñ–∏–ª—å</div>
  </nav>

  <script src="assets/js/profile-config.js"></script>
  <script src="assets/js/app.js"></script>

  <!-- –û—Ç–ª–∞–¥–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
  <script>
    const output = document.createElement('pre');
    output.id = 'auth-output';
    output.style.cssText = 'white-space:pre-wrap;padding:10px;font-family:monospace;background:#f3f3f3;border:1px solid #ccc;margin:10px;';
    document.body.appendChild(output);
    function print(msg) { output.textContent += msg + '\n'; }
    try {
      print('Telegram WebApp ready...');
      print('tg.initData: ' + (tg.initData || '–ø—É—Å—Ç–æ'));
      async function telegramAuth() {
        try {
          if (!tg.initData) { print('–û—à–∏–±–∫–∞: initData –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç!'); return; }
          const res = await fetch('https://dev.wtfbjj.ru/api/auth.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ initData: tg.initData })
          });
          print('–û—Ç–≤–µ—Ç: ' + res.status);
          const data = await res.json();
          if (!res.ok) { print('–û—à–∏–±–∫–∞: ' + JSON.stringify(data)); return; }
          localStorage.setItem('jwt_token', data.token);
          tg.BackButton.show();
          print('–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞');
        } catch (err) { print('–û—à–∏–±–∫–∞: ' + err.message); }
      }
      telegramAuth();
    } catch (err) { print('–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: ' + err.message); }
  </script>
  -->

</body>
</html>
