<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>TWA ‚Äî –ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤ (dev)</title>

  <!-- Font Awesome (–∏–∫–æ–Ω–∫–∏) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="assets/css/style.css" />
  <link rel="stylesheet" href="assets/css/dev.css" />

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.BackButton.hide();
  </script>
</head>
<body>

  <!-- header with compact search -->
  <div class="topbar">
    <div class="search-wrap">
      <div class="search" role="search">
        <i class="fa-solid fa-magnifying-glass"></i>
        <input id="searchInput" placeholder="–ü–æ–∏—Å–∫ –∫—É—Ä—Å–∞ –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..." autocomplete="off" />
      </div>
      <div id="suggestBox" aria-hidden="true"></div>
    </div>
  </div>

  <div class="banner-wrap">
    <div id="banner-carousel">
      <div class="banner" style="background: radial-gradient(87.56% 85.19% at 87.37% -15.14%, rgb(83, 255, 214) 0%, rgba(51, 169, 255, 0) 100%), radial-gradient(67.94% 70.77% at 0% 100%, rgb(113, 195, 255) 0%, rgb(93, 99, 255) 100%);" onclick="window.location.href='pages/banner1.html'">
        <div class="banner-text">
          <div class="banner-title">üî• –ù–µ–¥–µ–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
          <div class="banner-subtitle">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ></div>
        </div>
        <img class="banner-icon" src="assets/img/banner1.png" alt="–ù–µ–¥–µ–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫">
      </div>
      <div class="banner" style="background: linear-gradient(to right, #7B4FFF, #8E2DE2, #9C2ACE)" onclick="window.location.href='pages/banner2.html'">
        <div class="banner-text">
          <div class="banner-title">üéØ –î–ª—è —Ç–µ—Ö, –∫—Ç–æ –∑–Ω–∞–µ—Ç —á–µ–≥–æ —Ö–æ—á–µ—Ç</div>
          <div class="banner-subtitle">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ></div>
        </div>
        <img class="banner-icon" src="assets/img/banner2.png" alt="–ú–µ—Å—è—Ü —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫">
      </div>
      <div class="banner" style="background-image: linear-gradient(45deg, #FFD700, #CD853F)" onclick="window.location.href='pages/banner3.html'">
        <div class="banner-text">
          <div class="banner-title">üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∫–∞–Ω–∞–ª–æ–≤</div>
          <div class="banner-subtitle">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ></div>
        </div>
        <img class="banner-icon" src="assets/img/banner3.png" alt="–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å">
      </div>
    </div>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–∞—Ä—É—Å–µ–ª–∏ (—Ç–æ–ª—å–∫–æ –≤ dev) -->
    <div class="banner-dots" aria-hidden="true">
      <span class="banner-dot active"></span>
      <span class="banner-dot"></span>
      <span class="banner-dot"></span>
    </div>
  </div>

  <div id="catWrap">
    <div id="categories" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"></div>
  </div>

  <main class="container">

    <section id="page-catalog" class="page active">
      <div id="catalogQuickFilters" class="catalog-quick-filters" aria-label="–ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã">
        <button type="button" class="catalog-filter-chip active" data-filter="all">–í—Å–µ</button>
        <button type="button" class="catalog-filter-chip" data-filter="bookmarks">–í –∑–∞–∫–ª–∞–¥–∫–∞—Ö</button>
        <button type="button" class="catalog-filter-chip" data-filter="watched">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</button>
      </div>
      <div class="controls">
        <div class="small-muted" id="countInfo">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
      </div>
      <div id="courses" class="courses"></div>
    </section>

    <section id="page-leaderboard" class="page">
      <h2 style="margin:0 0 8px 0">–£—á–∞—Å—Ç–Ω–∏–∫–∏</h2>
      <div id="leaderboardMeBlock" class="leaderboard-me-block" style="display:none"></div>
      <div class="leaderboard-header leaderboard-row">
        <span class="leaderboard-rank">#</span>
        <span class="leaderboard-username">–ù–∏–∫</span>
        <span class="leaderboard-rating">–†–µ–π—Ç–∏–Ω–≥</span>
        <span class="leaderboard-level">–£—Ä–æ–≤–µ–Ω—å</span>
        <span class="leaderboard-belt">–ü–æ—è—Å</span>
      </div>
      <div id="leaderboardList" class="leaderboard-list"></div>
    </section>

    <section id="page-profile" class="page">
      <div class="profile-page">
        <!-- Hero -->
        <div class="profile-hero">
          <div class="profile-hero-firework" aria-hidden="true"></div>
          <button type="button" id="profileEditBtn" class="profile-edit-icon-btn profile-edit-icon-btn--hero" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" aria-label="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
            <i class="fa-solid fa-pen"></i>
          </button>
          <div id="profileAvatar" class="profile-avatar"></div>
          <h1 id="profileName" class="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
          <div id="profileBadges" class="profile-badges"></div>
        </div>

        <!-- –†–µ–π—Ç–∏–Ω–≥ (—Å–≤–µ—Ç–ª—ã–π –∑–æ–ª–æ—Ç–æ–π, –≤—ã—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–ª–∞—à–µ–∫) -->
        <div class="profile-rating-card">
          <div class="profile-block-header">
            <span class="profile-rating-title">–¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥</span>
            <button type="button" class="profile-hint-btn" data-hint="rating" title="–ü–æ–¥—Å–∫–∞–∑–∫–∞" aria-label="–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–π—Ç–∏–Ω–≥">
              <i class="fa-solid fa-circle-question"></i>
            </button>
          </div>
          <div class="profile-rating-bar-wrap">
            <div class="profile-rating-bar">
              <div class="profile-rating-fill" id="profileRatingFill" style="width:0%"></div>
              <span class="profile-rating-value" id="profileRating">0</span>
            </div>
          </div>
        </div>

        <!-- –ù–µ–±–æ–ª—å—à–∏–µ –ø–ª–∞—à–∫–∏: –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ + —É—Ä–æ–≤–µ–Ω—å -->
        <div class="profile-stats-compact">
          <div class="profile-mini-card profile-mini-card--watched">
            <div class="profile-block-header">
              <span class="profile-mini-label">–ö—É—Ä—Å–æ–≤ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ</span>
              <button type="button" class="profile-hint-btn" data-hint="watched" title="–ü–æ–¥—Å–∫–∞–∑–∫–∞" aria-label="–ß—Ç–æ —Ç–∞–∫–æ–µ –∫—É—Ä—Å–æ–≤ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ">
                <i class="fa-solid fa-circle-question"></i>
              </button>
            </div>
            <div class="profile-mini-bar">
              <div id="profileProgressFill" class="profile-mini-fill" style="width:0%"></div>
            </div>
          </div>
          <div id="profileLevelBlock" class="profile-mini-card profile-mini-card--level" style="display:none">
            <div class="profile-block-header profile-block-header--level">
              <span class="profile-mini-level" id="profileLevelText">–£—Ä–æ–≤–µ–Ω—å 1</span>
              <button type="button" class="profile-hint-btn" data-hint="level" title="–ü–æ–¥—Å–∫–∞–∑–∫–∞" aria-label="–ß—Ç–æ —Ç–∞–∫–æ–µ —É—Ä–æ–≤–µ–Ω—å">
                <i class="fa-solid fa-circle-question"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- –ü–æ–¥–ª–æ–∂–∫–∞ –∏ –ø–æ–ø–∞–ø –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤) -->
        <div id="profileHintBackdrop" class="profile-hint-backdrop" aria-hidden="true"></div>
        <div id="profileHintPopover" class="profile-hint-popover" role="dialog" aria-hidden="true">
          <div class="profile-hint-popover-inner">
            <p id="profileHintText" class="profile-hint-text"></p>
            <button type="button" class="profile-hint-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å"><i class="fa-solid fa-times"></i></button>
          </div>
        </div>

        <!-- –ó–∞–∫–ª–∞–¥–∫–∏ -->
        <div class="profile-stats-grid">
          <div class="profile-stat-card">
            <div class="profile-stat-value" id="profileBookmarksCount">0</div>
            <div class="profile-stat-label">–í –∑–∞–∫–ª–∞–¥–∫–∞—Ö</div>
          </div>
        </div>

        <!-- Achievements -->
        <div class="profile-section">
          <h2 class="profile-section-title">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
          <div id="profileAchievements" class="profile-achievements"></div>
        </div>

        <!-- Belt form (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) -->
        <div id="profileBeltFormWrap" class="profile-section profile-belt-section">
          <div id="profileBeltForm" class="profile-belt-form">
            <h3 class="profile-form-title">–ü–æ—è—Å, —Ä–∞–∑–¥–µ–ª –∏ –∫–ª—É–±</h3>
            <label class="profile-form-label">–ü–æ—è—Å</label>
            <div id="profileBeltPicker" class="profile-belt-picker"></div>
            <label class="profile-form-label">–†–∞–∑–¥–µ–ª</label>
            <div id="profileDivisionPicker" class="profile-division-picker"></div>
            <label class="profile-form-label">–ö–ª—É–± <span class="profile-form-optional">(–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span></label>
            <input type="text" id="profileClubInput" class="profile-club-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª—É–±–∞" maxlength="100" autocomplete="off">
            <div class="profile-form-actions">
              <button type="button" id="profileCancelBeltBtn" class="profile-cancel-btn" style="display:none">–û—Ç–º–µ–Ω–∞</button>
              <button type="button" id="profileSaveBeltBtn" class="profile-save-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <div id="toast"></div>

  <nav class="bottom-nav" role="navigation">
    <div class="nav-item active" data-target="page-catalog"><i class="fa-solid fa-book"></i>–ö–∞—Ç–∞–ª–æ–≥</div>
    <div class="nav-item" data-target="page-leaderboard"><i class="fa-solid fa-users"></i>–£—á–∞—Å—Ç–Ω–∏–∫–∏</div>
    <div class="nav-item" data-target="page-profile"><i class="fa-solid fa-user"></i>–ü—Ä–æ—Ñ–∏–ª—å</div>
  </nav>

  <script src="assets/js/profile-config.js"></script>
  <script src="assets/js/app.js"></script>

  <!-- –û—Ç–ª–∞–¥–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
  <script>
    const output = document.createElement('pre');
    output.id = 'auth-output';
    output.style.cssText = 'white-space:pre-wrap;padding:10px;font-family:monospace;background:#f3f3f3;border:1px solid #ccc;margin:10px;';
    document.body.appendChild(output);
    function print(msg) { output.textContent += msg + '\n'; }
    try {
      print('Telegram WebApp ready...');
      print('tg.initData: ' + (tg.initData || '–ø—É—Å—Ç–æ'));
      async function telegramAuth() {
        try {
          if (!tg.initData) { print('–û—à–∏–±–∫–∞: initData –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç!'); return; }
          const res = await fetch('https://dev.wtfbjj.ru/api/auth.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ initData: tg.initData })
          });
          print('–û—Ç–≤–µ—Ç: ' + res.status);
          const data = await res.json();
          if (!res.ok) { print('–û—à–∏–±–∫–∞: ' + JSON.stringify(data)); return; }
          localStorage.setItem('jwt_token', data.token);
          tg.BackButton.show();
          print('–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞');
        } catch (err) { print('–û—à–∏–±–∫–∞: ' + err.message); }
      }
      telegramAuth();
    } catch (err) { print('–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: ' + err.message); }
  </script>
  -->

</body>
</html>
